<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>创建HTTP/HTTPS服务器与客户端 | Laispace - 来思碑</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="创建HTTP服务器
  方法1：
  var server = http.createServer([requestListener])
  // requestListener = function (request, response) {
      // request 是一个 http.IncomingMessage对象
      // response 是一个 http.Serve">
<meta property="og:type" content="article">
<meta property="og:title" content="创建HTTP/HTTPS服务器与客户端">
<meta property="og:url" content="http://laispace.github.io/2014/05/创建http:https服务器与客户端/">
<meta property="og:site_name" content="Laispace - 来思碑">
<meta property="og:description" content="创建HTTP服务器
  方法1：
  var server = http.createServer([requestListener])
  // requestListener = function (request, response) {
      // request 是一个 http.IncomingMessage对象
      // response 是一个 http.Serve">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="创建HTTP/HTTPS服务器与客户端">
<meta name="twitter:description" content="创建HTTP服务器
  方法1：
  var server = http.createServer([requestListener])
  // requestListener = function (request, response) {
      // request 是一个 http.IncomingMessage对象
      // response 是一个 http.Serve">

  
    <link rel="alternative" href="/atom.xml" title="Laispace - 来思碑" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"> -->
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Laispace - 来思碑</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">天酬勤笨先飞，乐观进取。</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        <ul class="category-list">
          
            <li class="category-list-item">
                  <a class="category-list-link" href="/git">GIT</a>
            </li>
          
            <li class="category-list-item">
                  <a class="category-list-link" href="/web">WEB</a>
            </li>
          
            <li class="category-list-item">
                  <a class="category-list-link" href="/codereading">SVN</a>
            </li>
          
            <li class="category-list-item">
                  <a class="category-list-link" href="/archives">归档</a>
            </li>
          
            <li class="category-list-item">
                  <a class="category-list-link" href="/about">关于</a>
            </li>
          
        </ul>

<!--         
              <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/">CSS</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTML/">HTML</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hybrid/">Hybrid</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Javascript/">Javascript</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node/">Node</a><span class="category-list-count">25</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reading/">Reading</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tips/">Tips</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Translate/">Translate</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/后台编程/">后台编程</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/好文阅读/">好文阅读</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/来思碑记/">来思碑记</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/每日一发/">每日一发</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/碎片积累/">碎片积累</a><span class="category-list-count">1</span></li></ul>
         -->
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
          <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://laispace.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-创建http:https服务器与客户端" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/创建http:https服务器与客户端/" class="article-date">
  <time datetime="2014-05-12T01:36:45.000Z" itemprop="datePublished">5月 12 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Node/">Node<span class="article-category-count">25</span></a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      创建HTTP/HTTPS服务器与客户端
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#参考资料："><span class="toc-number">1.</span> <span class="toc-text">参考资料：</span></a></li></ol>
        <ul>
<li><p>创建HTTP服务器</p>
<p>  方法1：</p>
<pre><code>  <span class="keyword">var</span> server = http.createServer([requestListener])
  <span class="comment">// requestListener = function (request, response) {</span>
      <span class="comment">// request 是一个 http.IncomingMessage对象</span>
      <span class="comment">// response 是一个 http.ServerResponse对象</span>
  <span class="comment">// }</span>
</code></pre><p>  方法2：</p>
<pre><code>  <span class="keyword">var</span> server = http.createServer();
  <span class="comment">// 监听请求</span>
  server.on(<span class="string">'request'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(request, response)</span> </span>{
      <span class="comment">// callback code here.</span>
  })        
  <span class="comment">// 监听端口</span>
  <span class="comment">// port 若为0则分配随机端口号</span>
  <span class="comment">// host 缺省则监听来自任何ipv4地址的客户端连接</span>
  <span class="comment">// backlog 默认为511，设定等待队列中最大的连接数，超过则拒绝</span>
  server.listen(port, [host], [backlog], [<span class="keyword">callback</span>])

  <span class="comment">// 或</span>
  server.on(<span class="string">'listening'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(request, response)</span> </span>{
      <span class="comment">// callback code here.</span>
  })
</code></pre></li>
</ul>
<a id="more"></a>

<pre><code>示例：

    <span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);
    <span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span> <span class="params">(req, res)</span> </span>{
        <span class="comment">// console.log('客户端请求信息为：', req);</span>
        <span class="built_in">console</span>.log(<span class="string">'客户端请求方法为：'</span>, req.method);
        <span class="built_in">console</span>.log(<span class="string">'客户端请求url为：'</span>, req.url);
        <span class="built_in">console</span>.log(<span class="string">'客户端请求头为：'</span>, req.headers);
        <span class="built_in">console</span>.log(<span class="string">'客户端请求HTTP版本为：'</span>, req.httpVersion);

        <span class="comment">// 监听客户端发来的数据</span>
        req.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(data)</span> </span>{
            <span class="built_in">console</span>.log(<span class="string">'服务器接收到数据：'</span>, data);
        });
        req.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{
            <span class="built_in">console</span>.log(                <span class="string">'服务器接收数据完毕'</span>);
        })

        <span class="comment">// 设置超时</span>
        res.setTimeout(<span class="number">1000</span>);
        res.on(<span class="string">'timeout'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{
            <span class="built_in">console</span>.log(<span class="string">'服务器响应超时'</span>);
        })
        <span class="comment">// 监听关闭</span>
        res.on(<span class="string">'close'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{
            <span class="built_in">console</span>.log(<span class="string">'连接被中断'</span>);
        })


        <span class="comment">// 发送服务器端的响应数据</span>
        <span class="comment">// res.writeHead(statusCode, [reasonPhase], [headers])</span>
        <span class="comment">// starusCode 为HTTP状态码</span>
        <span class="comment">// reasonPhase 为状态码的描述信息</span>
        <span class="comment">// headers 指定响应头对象，或使用 res.setHeader(name, value) 单独设置</span>
        res.writeHead(<span class="number">200</span>, {<span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span>});
        res.write(<span class="string">'hello 赖小赖！\n'</span>);
        res.write(<span class="string">'hello 我是继续写入的赖小赖！\n'</span>);
        res.write(<span class="string">'hello 我是调皮的赖小赖！\n'</span>);
        <span class="comment">// 必须使用 end() 结束响应</span>
        res.end(<span class="string">'好吧，我不玩了，掰掰！'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{
            <span class="comment">// console.log('已结束响应');</span>
        });
    });
    <span class="comment">// 监听端口</span>
    server.listen(<span class="number">1234</span>, <span class="string">'localhost'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{
        <span class="built_in">console</span>.log(<span class="string">'服务器正在监听端口1234'</span>);

        <span class="comment">// 关闭服务器</span>
        <span class="comment">// server.close();</span>
    });
    <span class="comment">// 设置超时, 默认为2分钟，这里设定为1分钟</span>
    server.setTimeout(<span class="number">60</span>*<span class="number">1000</span>, <span class="function"><span class="keyword">function</span> <span class="params">(socket)</span> </span>{
        <span class="comment">// 超时后执行回调</span>
        <span class="comment">// console.log('服务器超时：', socket);</span>
    })

    <span class="comment">// 监听连接</span>
    server.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(socket)</span> </span>{
        <span class="built_in">console</span>.log(<span class="string">'客户端连接已建立'</span>);
    })


    <span class="comment">// 监听关闭</span>
    server.on(<span class="string">'close'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{
        <span class="built_in">console</span>.log(<span class="string">'服务器已被关闭'</span>);
    });
    <span class="comment">// 监听错误</span>
    server.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>{
        <span class="comment">// 端口被占用</span>
        <span class="keyword">if</span> (e.code == <span class="string">'EADDRINUSE'</span>) {
            <span class="built_in">console</span>.log(<span class="string">'error: 端口已被占用'</span>);
        }
    });


使用 querystring模块 处理查询字符串

    - querystring.parse() 处理查询字符串

    <span class="comment">// str为查询字符串</span>
    <span class="comment">// sep 设定查询字符串中的分隔符，默认为 &amp;</span>
    <span class="comment">// eq 设定查询字符串中的分配符，默认为 = </span>
    <span class="comment">// querystring.parse(str, [sep], [eq], [options])</span>
    <span class="keyword">var</span> str = <span class="string">'name=xiaolai&amp;age=18&amp;sex=male'</span>;
    querystring.parse(str);
    <span class="comment">// 将输出 {</span>
    <span class="comment">//    name: 'xiaolai',</span>
    <span class="comment">//    age: 18,</span>
    <span class="comment">//    sex: 'male'</span>
    <span class="comment">// }</span>

    - querystring.stringify() 转换对象为查询字符串
    <span class="comment">// querystring.stringify(obj, [sep], [eq])</span>
    <span class="keyword">var</span> obj = {
        name: <span class="string">'xiaolai'</span>,
        age: <span class="number">18</span>,    <span class="comment">// 好吧 就让我再年轻一次！！！</span>
        sex: <span class="string">'male'</span>
    };
    <span class="keyword">var</span> str = querystring.stringify(obj);
    <span class="comment">// 将输出 name=xiaolai&amp;age=18&amp;sex=male</span>

使用 url模块 处理完整的URL字符串

    - url.parse() 处理字符串

    <span class="comment">// parseQueryString 默认为false, 为true时，将字符串中的查询字符串转化为对象</span>
    <span class="comment">// url.parse(str, [parseQueryString])</span>
    <span class="keyword">var</span> str = <span class="string">'http://user:pwd@laispace.com:80/user/xiaolai?age=18&amp;sex=male#section1'</span>;
    <span class="keyword">var</span> strObj1 = url.parse(str);
    <span class="keyword">var</span> strObj2 = url.parse(str, <span class="literal">true</span>);
    <span class="built_in">console</span>.log(strObj1, strObj2);
    <span class="comment">// strObj1.query 为 'age=18&amp;sex=male'</span>
    <span class="comment">// strObj2.query 为 {age: '18', sex: 'male'}</span>

    - url.format() 转换对象为字符串

    <span class="keyword">var</span> str = url.format(strObj1);
    <span class="built_in">console</span>.log(str);

    - url.resolve() 合并路径

    <span class="comment">// url.resolve(form, to);</span>
    <span class="keyword">var</span> str = url.resolve(<span class="string">'http://laispace.com'</span>, <span class="string">'user/xiaolai'</span>)
    <span class="built_in">console</span>.log(str)/ =&gt;<span class="string">'http://laispace.com/user/xiaolai'</span>
</code></pre><ul>
<li><p>创建HTTP客户端</p>
<pre><code>  <span class="comment">// options 为对象，若为地址字符串则自动parse为对象</span>
  <span class="comment">// options.host 指定IP地址，默认为 localhost</span>
  <span class="comment">// options.hostname 默认为 localhost</span>
  <span class="comment">// options.port 指定端口</span>
  <span class="comment">// localAddress 指定专用于网络连接的本地端口</span>
  <span class="comment">// socketPath 指定目标Unix域端口</span>
  <span class="comment">// method 指定HTTP请求方法，默认为 GET</span>
  <span class="comment">// path 指定请求路径和查询字符串</span>
  <span class="comment">// headers 指定请求头对象</span>
  <span class="comment">// auth 指定认证信息，如 "user: password"</span>
  <span class="comment">// agent 指定代理，是一个 http.Agent对象    </span>

  <span class="keyword">var</span> req = http.request(options, <span class="function"><span class="keyword">function</span> <span class="params">(response)</span> </span>{
      <span class="comment">// response code here.</span>
  })    
  <span class="comment">// 发送数据</span>
  req.write(chunk, [encoding]);
  <span class="comment">// 结束请求</span>
  req.end([chunk], [encoding]);
</code></pre><p>  示例：</p>
<pre><code>  <span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);
  <span class="keyword">var</span> options = {
      hostname: <span class="string">'www.laispace.com'</span>,
      post: <span class="number">80</span>,
      path: <span class="string">'/'</span>,
      method: <span class="string">'GET'</span>
  };
  <span class="keyword">var</span> req = http.request(options, <span class="function"><span class="keyword">function</span> <span class="params">(res)</span> </span>{
      <span class="comment">// console.log('响应信息：', res);</span>
      <span class="built_in">console</span>.log(<span class="string">'响应状态码：'</span>, res.statusCode);
      <span class="built_in">console</span>.log(<span class="string">'响应头：'</span>);
      <span class="comment">// 设定编码</span>
      res.setEncoding(<span class="string">'utf8'</span>);
      <span class="keyword">var</span> body = <span class="string">''</span>;
      <span class="comment">// 监听响应数据</span>
      res.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(chunk)</span> </span>{
          <span class="built_in">console</span>.log(<span class="string">'接收到响应数据：'</span>, chunk);
          body += chunk;
      })
      res.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{
          <span class="comment">// console.log('响应数据已全部接受：', body);</span>
      })
  })
  <span class="comment">// 写入请求数据</span>
  <span class="comment">// req.write('Hello 我是小赖');</span>
  <span class="comment">// 发起请求</span>
  req.end();

  <span class="comment">// 监听错误，如访问一个不存在的地址时</span>
  req.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(err)</span> </span>{
      <span class="keyword">if</span> (err.code === <span class="string">'ECONNRESET'</span>) {
          <span class="built_in">console</span>.log(<span class="string">'socket 端口超时'</span>)
      } <span class="keyword">else</span> {
          <span class="built_in">console</span>.log(<span class="string">'请求发生错误：'</span>, err);
      }

  });
  <span class="comment">// 设定超时</span>
  req.setTimeout(<span class="number">1000</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{
      <span class="comment">// 终止请求</span>
      <span class="comment">// req.abort()        </span>
  })    
</code></pre><p>  除了使用 http.request(options, callback) 外，</p>
<p>  也可以使用简化的 http.get(options, callback) ，</p>
<p>  其默认使用 GET 并会自动调用 end() 方法发起请求</p>
</li>
</ul>
<ul>
<li><p>创建HTTP代理服务器    </p>
<pre><code>  <span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);
  <span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);
  <span class="comment">// 建立代理服务器</span>
  <span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span> <span class="params">(clientReq, clientRes)</span> </span>{
      <span class="keyword">var</span> url_parts = url.parse(clientReq.url);
      <span class="keyword">var</span> options = {
          host: <span class="string">'www.laispace.com'</span>, <span class="comment">// =&gt;真正访问的网站host</span>
          port: <span class="number">80</span>,
          path: url_parts.pathname,
          headers: clientReq.headers
      };
      <span class="comment">// 服务器代理客户端发起请求</span>
      <span class="keyword">var</span> serverReq = http.get(options, <span class="function"><span class="keyword">function</span> <span class="params">(serverRes)</span> </span>{
          <span class="comment">// 代理服务器得到的响应返回给客户端</span>
          clientRes.writeHead(serverRes.statusCode, serverRes.headers);
          <span class="comment">// 代理服务器请求到的数据返回给客户端</span>
          serverRes.pipe(clientRes);
      });            
      <span class="comment">// 将客户端请求</span>
      clientReq.pipe(serverReq);
  });
  server.listen(<span class="number">1234</span>, <span class="string">'localhost'</span>);
</code></pre><p>  保存这段代码到 test.js</p>
<p>  执行 $ node test.js</p>
<p>  浏览器访问 <a href="http://localhost:1234" target="_blank" rel="external">http://localhost:1234</a> 则会访问到 www.laispace.com </p>
</li>
<li><p>创建HTTPS服务器    </p>
<p>  HTTPS 相比于 HTTP：</p>
<pre><code>  -<span class="ruby"> <span class="constant">HTTPS</span>服务器向<span class="constant">CA</span>申请证书
</span>
  -<span class="ruby"> <span class="constant">HTTPS</span>传输的是经过<span class="constant">SSL</span>加密后的数据
</span>
  -<span class="ruby"> <span class="constant">HTTPS</span>常用<span class="number">443</span>端口，而<span class="constant">HTTP</span>常用<span class="number">80</span>端口</span>
</code></pre><p>  SSL简单介绍：</p>
<pre><code>  -<span class="ruby"> 私钥和公钥保存在服务器
</span>
  -<span class="ruby"> 公钥发送到客户端，客户端端发送 消息msg1 给服务器
</span>
  -<span class="ruby"> 服务器将 消息msg1 进行哈希运算得到 hash1字符串 并用私钥加密后发送 消息msg2 传回客户端
</span>
  -<span class="ruby"> 客户端使用公钥解密 消息msg2 ，将 消息msg1 进行哈希运算得到 hash2字符串，与hash1字符串 进行比较
</span>
  -<span class="ruby"> 若 hash1 与 hash2 相等则握手成功
</span>
  -<span class="ruby"> 客户端选择加密算法和相应密钥，用公钥加密后发送给服务器
</span>
  -<span class="ruby"> 服务器收到加密算法和响应密钥，开始与客户端传输数据        </span>
</code></pre><ol>
<li><p>创建私钥：</p>
<pre><code> $ openssl genrsa -<span class="keyword">out</span> privatekey.pem <span class="number">1024</span>
</code></pre></li>
<li><p>创建证书签名请求(Certificate Signing Request)文件：</p>
<pre><code> $ openssl req -<span class="keyword">new</span> -key privatekey.pem -<span class="keyword">out</span> certrequest.csr
</code></pre></li>
<li><p>获取证书：（这里是使用 openssl 创建的测试用的证书-访问网站会被警告，真正的证书要向CA申请）</p>
<pre><code> $ openssl x509 -req -<span class="keyword">in</span> certrequest.csr -signkey privatekey.pem -<span class="keyword">out</span> certificate.pem
</code></pre></li>
<li><p>创建pfx文件（为存储私钥、公钥和证书的一种格式）：</p>
<pre><code> $ openssl pkcs12 -<span class="keyword">export</span> -<span class="keyword">in</span> certificate.pem -inkey privatekey.pem -<span class="keyword">out</span> certificate.pfx
</code></pre><p>具备以上条件后，使用 https.createServer(options, [requestListener]) 创建HTTPS服务器：</p>
<p> var https = require(‘https’);<br> var fs = require(‘fs’);</p>
<p> var pk = fs.readFileSync(‘./privatekey.pem’);<br> var pc = fs.readFileSync(‘./certificate.pem’);</p>
<p> var options = {</p>
<pre><code> <span class="attribute">key</span>: <span class="string">pk,</span>
 <span class="attribute">cert</span>: <span class="string">pc</span>
</code></pre><p> };<br> var server = https.createServer(options, function (req, res) {</p>
<pre><code> <span class="keyword">res</span>.<span class="keyword">write</span>(<span class="string">'Hello 赖小赖！'</span>);
 <span class="keyword">res</span>.end();
</code></pre><p> });<br> server.listen(1234, ‘localhost’, function () {</p>
<pre><code> console.<span class="built_in">log</span>(<span class="string">'HTTPS服务器已开启，正在监听端口1234'</span>);
</code></pre><p> })</p>
</li>
</ol>
</li>
<li><p>创建HTTPS客户端</p>
<pre><code>  <span class="keyword">var</span> https = <span class="built_in">require</span>(<span class="string">'https'</span>);

  <span class="keyword">var</span> options = {
      hostname: <span class="string">'npmjs.org'</span>,
      port: <span class="number">443</span>,
      path: <span class="string">'/'</span>,
      method: <span class="string">'GET'</span>,
      agent: <span class="literal">false</span> <span class="comment">// 设置为false表示自动选择代理</span>
  };
  <span class="keyword">var</span> req = https.request(options, <span class="function"><span class="keyword">function</span> <span class="params">(res)</span> </span>{
      <span class="built_in">console</span>.log(<span class="string">'响应状态码：'</span>, res.statusCode);
      <span class="built_in">console</span>.log(<span class="string">'响应头：'</span>, res.headers);
      <span class="comment">// 接收数据</span>
      res.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(chunk)</span> </span>{
          <span class="built_in">console</span>.log(<span class="string">'响应内容：'</span>, chunk.toString());
      });
  });
  <span class="comment">// 发送请求</span>
  req.end();
  <span class="comment">// 设置超时</span>
  req.setTimeout(<span class="number">1000</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{
      <span class="built_in">console</span>.log(<span class="string">'连接超时'</span>);
      <span class="comment">// 终止请求</span>
      req.abort();
  })
  req.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(err)</span> </span>{
      <span class="built_in">console</span>.log(<span class="string">'出错啦！'</span>)
  })
</code></pre><p>  除以上提出的区别外，HTTPS服务器的编写（如错误监听、设置超时、关闭服务器等）与HTTP服务器的编写方法基本相同，详见官方文档。        </p>
<p>  默认是GET方法时，也可以使用 https.get(options, callback)，自动调用 end() 方法发起请求，这时HTTPS服务器编写也与HTTP服务器的编写方式相同，参见上文。</p>
</li>
</ul>
<h3 id="参考资料：">参考资料：</h3>
<ol>
<li><a href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html" target="_blank" rel="external">SSL/TLS协议运行机制的概述</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <!--
      <a data-url="http://laispace.github.io/2014/05/创建http:https服务器与客户端/" data-id="01cg45udp5689zhc" class="article-share-link">Share</a>
      -->
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTTP/">HTTP</a><span class="article-tag-list-count">1</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTTPS/">HTTPS</a><span class="article-tag-list-count">1</span></li></ul>

      
      <section id="comments">
        <div class="ds-thread" data-thread-key="01cg45udp5689zhc" data-title="创建HTTP/HTTPS服务器与客户端" data-url="http://laispace.github.io/2014/05/创建http:https服务器与客户端/"></div>
      <script type="text/javascript">
      var duoshuoQuery = {short_name:"laispace"};
        (function() {
          var ds = document.createElement('script');
          ds.type = 'text/javascript';ds.async = true;
          ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
          ds.charset = 'UTF-8';
          (document.getElementsByTagName('head')[0]
           || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
        </script>
      </section>
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/05/nodejs常用模块/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          NODEJS-常用模块
        
      </div>
    </a>
  
  
    <a href="/2014/05/使用net模块创建tcp服务器/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">使用net模块创建TCP服务器</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2014/12/JavaScript 碎片/">JavaScript 碎片</a>
          </li>
        
          <li>
            <a href="/2014/12/移动 Web 开发技巧/">移动 Web 开发技巧</a>
          </li>
        
          <li>
            <a href="/2014/11/Web-worker-的简单使用/">Web worker 的简单使用</a>
          </li>
        
          <li>
            <a href="/2014/11/常用字符集和编码格式/">常用字符集和编码格式</a>
          </li>
        
          <li>
            <a href="/2014/09/【译】ES6 Generators（4）并发篇/">【译】ES6 Generators（4）并发篇</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/">CSS</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTML/">HTML</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hybrid/">Hybrid</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Javascript/">Javascript</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node/">Node</a><span class="category-list-count">25</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reading/">Reading</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tips/">Tips</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Translate/">Translate</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/后台编程/">后台编程</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/好文阅读/">好文阅读</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/来思碑记/">来思碑记</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/每日一发/">每日一发</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/碎片积累/">碎片积累</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/-crawler-spider/" style="font-size: 10.00px;">-crawler -spider</a><a href="/tags/-linux/" style="font-size: 10.00px;">-linux</a><a href="/tags/Child-process/" style="font-size: 10.00px;">Child_process</a><a href="/tags/Cluster/" style="font-size: 10.00px;">Cluster</a><a href="/tags/ES6/" style="font-size: 20.00px;">ES6</a><a href="/tags/FormData/" style="font-size: 10.00px;">FormData</a><a href="/tags/HTML5/" style="font-size: 10.00px;">HTML5</a><a href="/tags/HTTP/" style="font-size: 10.00px;">HTTP</a><a href="/tags/HTTPS/" style="font-size: 10.00px;">HTTPS</a><a href="/tags/Mongo/" style="font-size: 10.00px;">Mongo</a><a href="/tags/NPM/" style="font-size: 10.00px;">NPM</a><a href="/tags/Node/" style="font-size: 15.00px;">Node</a><a href="/tags/Node-modules/" style="font-size: 10.00px;">Node modules</a><a href="/tags/Notes/" style="font-size: 15.00px;">Notes</a><a href="/tags/Notification/" style="font-size: 10.00px;">Notification</a><a href="/tags/Phonegap/" style="font-size: 10.00px;">Phonegap</a><a href="/tags/SAE/" style="font-size: 10.00px;">SAE</a><a href="/tags/Tools/" style="font-size: 10.00px;">Tools</a><a href="/tags/Ubuntu/" style="font-size: 10.00px;">Ubuntu</a><a href="/tags/ajax/" style="font-size: 10.00px;">ajax</a><a href="/tags/animate/" style="font-size: 10.00px;">animate</a><a href="/tags/async/" style="font-size: 10.00px;">async</a><a href="/tags/base64/" style="font-size: 10.00px;">base64</a><a href="/tags/blur/" style="font-size: 10.00px;">blur</a><a href="/tags/buffer/" style="font-size: 15.00px;">buffer</a><a href="/tags/bytewiser/" style="font-size: 10.00px;">bytewiser</a><a href="/tags/clearSelect/" style="font-size: 10.00px;">clearSelect</a><a href="/tags/concat-stream/" style="font-size: 10.00px;">concat-stream</a><a href="/tags/cookies/" style="font-size: 10.00px;">cookies</a><a href="/tags/css3/" style="font-size: 10.00px;">css3</a><a href="/tags/debug/" style="font-size: 10.00px;">debug</a><a href="/tags/dns/" style="font-size: 10.00px;">dns</a><a href="/tags/express/" style="font-size: 10.00px;">express</a><a href="/tags/fileupload/" style="font-size: 10.00px;">fileupload</a><a href="/tags/filter/" style="font-size: 10.00px;">filter</a><a href="/tags/flex/" style="font-size: 10.00px;">flex</a><a href="/tags/fs/" style="font-size: 15.00px;">fs</a><a href="/tags/generators/" style="font-size: 20.00px;">generators</a><a href="/tags/git/" style="font-size: 10.00px;">git</a><a href="/tags/goagent/" style="font-size: 10.00px;">goagent</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a><span class="archive-list-count">16</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">March 2014</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">February 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/01/">January 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">November 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">October 2013</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">September 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">August 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">June 2013</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/05/">May 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">March 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">December 2012</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">November 2012</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">October 2012</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">August 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">July 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">May 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/12/">December 2011</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2014 赖小赖<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
<!--     <nav id="mobile-nav">
  
    <a href="/git" class="mobile-nav-link">GIT</a>
  
    <a href="/web" class="mobile-nav-link">WEB</a>
  
    <a href="/codereading" class="mobile-nav-link">SVN</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav> -->
    

<script src="http://cdn.staticfile.org/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>